package hw7;

import java.util.ArrayList;

public class Fraction {

	int numerator;
	int denominator;

	// constructor
	/**
	 * Create fraction with a given numerator and denominator and formats the
	 * negative fraction
	 * 
	 * @param numerator
	 * @param denominator
	 */

	public Fraction(int numerator, int denominator) {
		if (denominator == 0) {
			throw new ArithmeticException("Divide by zero");
		}
		this.numerator = numerator;
		this.denominator = denominator;

		this.formatNegativeFraction();
	}

	/**
	 * 10/-15-->-10/15
	 */

	void formatNegativeFraction() {
		if (this.denominator < 0) {
			this.denominator *= -1;
			this.numerator *= -1;
		}
	}

	/**
	 * Find all divisors of the given num.
	 * 
	 */

	ArrayList<Integer> findDivisors(int num) {
		ArrayList<Integer> divisors = new ArrayList<Integer>();

		if (num < 0) {
			num *= -1;
		}

		for (int i = num; i >= 1; i--) {
			if (num % i == 0) {
				divisors.add(i);
			}
		}
		return divisors;
	}

	public void reduceToLowestForm() {

		if (this.numerator == 0) {
			this.numerator = 0;
			this.denominator = 1;
		} else if (this.numerator % this.denominator == 0) {
			this.numerator = this.numerator / this.denominator;
			this.denominator = 1;
		} else {
			ArrayList<Integer> divisorsNum = this.findDivisors(this.numerator);
			ArrayList<Integer> divisorsDen = this.findDivisors(this.denominator);

			int gcf = findGreatestCommonFactor(divisorsNum, divisorsDen);

			this.numerator = this.numerator / gcf;
			this.denominator = this.denominator / gcf;

			this.formatNegativeFraction();
		}
	}

	private int findGreatestCommonFactor(ArrayList<Integer> divisorsNum, ArrayList<Integer> divisorsDen) {
		// TODO Auto-generated method stub
		return 0;
	}

	private ArrayList<Integer> findDivisors1(int numerator2) {
		// TODO Auto-generated method stub
		return null;
	}

	public Fraction add(Fraction otherFraction) {

		int sumNumerator;
		int sumDenominator;

		if (this.denominator == otherFraction.denominator) {
			int newNumerator = this.numerator + otherFraction.numerator;
			sumNumerator = newNumerator;
			sumDenominator = this.denominator;
		} else {
			int lcm = findLeastCommonMultiple(this.denominator, otherFraction.denominator);

			int thisNewNumerator = (lcm / this.denominator) * this.denominator;
			int otherNewNumerator = (lcm / otherFraction.denominator) * otherFraction.numerator;

			int newNumerator = thisNewNumerator + otherNewNumerator;

			sumNumerator = newNumerator;
			sumDenominator = lcm;
		}
		Fraction newFraction = new Fraction(sumNumerator, sumDenominator);
		newFraction.reduceToLowestForm();
		return newFraction;
	}

	public Fraction subtract(Fraction otherFraction) {

		int difNumerator;
		int difDenominator;

		if (this.denominator == otherFraction.denominator) {
			int newNumerator = this.numerator - otherFraction.numerator;

			difNumerator = newNumerator;
			difDenominator = this.denominator;
		} else {
			int lcm = findLeastCommonMultiple(this.denominator, otherFraction.denominator);
			int thisNewNumerator = (lcm / this.denominator) * this.numerator;
			int otherNewNumerator = (lcm / otherFraction.denominator) * otherFraction.numerator;

			int newNumerator = thisNewNumerator - otherNewNumerator;
			difNumerator = newNumerator;
			difDenominator = lcm;
		}
		Fraction newFraction = new Fraction(difNumerator, difDenominator);
		newFraction.reduceToLowestForm();

		return newFraction;
	}

	public Fraction mul(Fraction otherFraction) {

		this.reduceToLowestForm();
		otherFraction.reduceToLowestForm();

		int prodNumerator = this.numerator * otherFraction.numerator;
		int prodDenominator = this.denominator * otherFraction.denominator;

		Fraction newFraction = new Fraction(prodNumerator, prodDenominator);
		newFraction.reduceToLowestForm();
		return newFraction;
	}

	public Fraction div(Fraction otherFraction) {

		this.reduceToLowestForm();
		otherFraction.reduceToLowestForm();

		int otherNumerator = otherFraction.numerator;
		int otherDenominator = otherFraction.denominator;
		otherFraction.numerator = otherDenominator;
		otherFraction.denominator = otherNumerator;

		Fraction newFraction = this.mul(otherFraction);
		newFraction.reduceToLowestForm();

		return newFraction;
	}

	/***
	 * return fraction to decimal
	 * 
	 * @return
	 */

	public double decimal() {
		double doubleDenominator = (double) this.denominator;
		return this.numerator / doubleDenominator;
	}

	public void sqr() {
		Fraction otherFraction = new Fraction(this.numerator, this.denominator);
		Fraction newFraction = this.mul(otherFraction);
		this.numerator = newFraction.numerator;
		this.denominator = newFraction.denominator;
	}

	public Fraction average(Fraction otherFraction) {

		Fraction sumFractions = this.add(otherFraction);
		Fraction twoFractions = new Fraction(2, 1);
		Fraction divFraction = sumFractions.div(twoFractions);
		return divFraction;
	}

	public static Fraction average(Fraction[] fractions) {

		Fraction divFraction = new Fraction(0, 1);
		int numFractions = fractions.length;
		if (numFractions > 0) {
			Fraction sumFractions = fractions[0];
			for (int i = 1; i < numFractions; i++) {
				sumFractions = sumFractions.add(fractions[i]);
			}
			Fraction lenFraction = new Fraction(numFractions, 1);
			divFraction = sumFractions.div(lenFraction);
			divFraction.reduceToLowestForm();
		}
		return divFraction;
	}

	public static Fraction average(int[] ints) {

		Fraction divFraction = new Fraction(0, 1);
		int numInts = ints.length;

		if (numInts > 0) {
			int sumInts = ints[0];
			for (int i = 1; i < numInts; i++) {
				sumInts += ints[i];
			}
			divFraction = new Fraction(sumInts, numInts);
			divFraction.reduceToLowestForm();
		}
		return divFraction;
	}

	@Override
	public boolean equals(Object object) {
		//if (!(object instanceof Fraction)) {
			//return false;
		//}
		Fraction thisFraction = new Fraction(this.numerator, this.denominator);
		thisFraction.reduceToLowestForm();

		Fraction otherFraction = (Fraction) object;
		otherFraction = new Fraction(otherFraction.numerator, otherFraction.denominator);
		otherFraction.reduceToLowestForm();

		return (thisFraction.numerator == otherFraction.numerator
				&& thisFraction.denominator == otherFraction.denominator);
	}

	@Override
	public String toString() {

		return this.numerator + "/" + this.denominator;
	}

	int findLeastCommonMultiple(int num1, int num2) {
		int lcm = 0;
		// abs value
		if (num1 < 0) {
			num1 *= -1;
		}
		if (num2 < 0) {
			num2 *= -1;
		}

		if ((num1 > num2) && (num1 % num2 == 0)) {
			lcm = num1;
		} else if ((num2 > num1) && (num2 % num1 == 0)) {
			lcm = num2;
		} else {
			lcm = num1 * num2;
		}
		return lcm;
	}

	int findGreatCommonMultiple(int num1, int num2) {
		int gcf = 0;
		// abs value
		if (num1 < 0) {
			num1 *= -1;
		}
		if (num2 < 0) {
			num2 *= -1;
		}

		if (num2 == 0)
			return num1;
		return findGreatCommonMultiple(num2, num1 % num2);

	}

	public int gcd(int num1, int num2) {

		// abs value
		if (num1 < 0) {
			num1 *= -1;
		}
		if (num2 < 0) {
			num2 *= -1;
		}

		if (num1 == 0) {
			return num2;
		} else {
			return gcd(num2, num1 % num2);
		}
	}
}
